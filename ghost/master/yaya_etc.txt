//******************************************************************************
// あやりりすEX　ゴーストテンプレート
// 種々のイベント辞書
//******************************************************************************

//******************************************************************************
//時報/重なり
//******************************************************************************

//------------------------------------------------------------------------------
//OnMinuteChangeイベント
//------------------------------------------------------------------------------

//時報
時報0時
{
	if rank != 0 {
		<<"
		真6：あ、日付変わっちゃったね。
		">>
	} else {
		<<"
		ユ：……もうこんな時間か。
		">>
	}
}
時報1時
{
	if rank != 0 {
		<<"
		真2：1時だね。
		改行多め真3：…夜更かしは、お肌に良くないんだよ。
		">>
	}
}

時報2時
{
	if rank != 0 {
		<<"
		真5：\i[4]ふあ……。
		改行多め真30：ちょっと、眠くなってきた…。
		">>
	}
}

時報3時
{
	if rank != 0 {
		<<"
		真3：…\w9…\w9むにゃ、\w9
		真：うーん…\w9…\w9、\w9((ユーザ)さん|%(sand))…\w9…\w9。\w9
		真：\n…\w9…\w9…\w9…\w9\s[6]\i[2]！
		">>
	}
}

時報4時
{
	時報3時
}

時報5時
{
	if rank != 0 {
		<<"
		真：朝だね、早起きさんだー。
		改行多め真4：…っていうか、徹夜？
		">>
	}
}

時報8時
{
	if rank != 0 {
		<<'
		真：8時だね。
		改行多め真8：今日も1日頑張ろう。
		'>>
	}
}

時報12時
{
	if rank != 0 {
		<<"
		真0：12時だね。
		改行多め真4：お昼、何食べようかな…。
		">>
	}
}

時報15時
{
	if rank != 0 {
		<<"
		真0：15時だね。
		改行多め真4：コーヒーとお菓子でも、買ってこようかな。
		">>
	}
}

時報18時
{
	if rank != 0 {
		<<"
		真：18時だね。
		改行多め真14：お腹減ってきた…。
		">>
	}
}

//******************************************************************************
//キー入力
//******************************************************************************

//ランダムトーク
キー入力T
{
	'\![raise,OnAiTalk]'
}

//SHIORiリロード
キー入力R
{
	'\![reload,shiori]\_q【SHIORIをリロード】'
}

//ランダムトーク
キー入力C
{
	if rank >= 2 {Menu_Communicate}
}

//メニュー
キー入力M
{
	if SHIORI3FW.IsChain {
	} else {OpenMenu}
}

//開発用メニュー
キー入力O
{
	Menu_USERCOMSTART
}

//******************************************************************************
//サーフィス復元
//******************************************************************************

// ------------------------------------------------------------------------------
// OnSurfaceRestoreイベント(ここは書き換えなくて構いません)
// 一定時間経った後、0番10番以外に戻したい場合は、\s[0] \s[10]の数字部を
// 書き換えてください。
// ------------------------------------------------------------------------------
OnSurfaceRestore
{
	if rank == 0 {"\0\s[4]\e"}
	else {"\0\s[0]\1\s[10]\e"}
}

//******************************************************************************
//着せ替え
//******************************************************************************
OnDressupChanged
{
	case reference[1] {
// 		when "いつもの服" {
// 			<<"
// 			真0：\w9オレンジ、似合うっしょ。
// 			">>
// 		}
// 		when "白シャツ" {
// 			<<"
// 			真6：\w9みてみて！
// 			ユ：シャツも似合うな。
// 			真8：…そこよりも、靴を見てよ。
// 			ユ：ええ……。
// 			">>
// 		}
// 		when "セーター" {
// 			<<"
// 			真0：みてみて、セーター。
// 			ユ：可愛いじゃないか。
// 			真4：…やっぱり、そういう目で見てるんだ。
// 			ユ：やめなさい。
// 			">>
// 		}
	} 
}

//******************************************************************************
//シェル切り替え
//******************************************************************************

//------------------------------------------------------------------------------
//シェルチェンジ開始
//------------------------------------------------------------------------------

//シェル変更前・後
//シェル再読み込み前・後
//シェル(名前)変更前・後

シェル変更前
{
	<<"
	真：\_q【シェルを変更】\_q
	真【rank!=0】：…ちょっと待っててね。\w9
	">>
}

//------------------------------------------------------------------------------
//シェルチェンジ完了
//------------------------------------------------------------------------------
シェル変更後
{
	if rank != 0 {
		<<"
		真1【rank!=0】：じゃーん。
		\s[0]…似合うかな？
		">>
	}
}


//******************************************************************************
//インストール関連
//******************************************************************************

//------------------------------------------------------------------------------
//インストール中のメッセージ
//------------------------------------------------------------------------------
OnInstallBegin
{
	<<"
	真：\_q【インストール開始】\_q
	真0 【rank!=0】：何だろう。わくわく。
	">>
}

//------------------------------------------------------------------------------
//インストール完了メッセージ
//------------------------------------------------------------------------------
OnInstallComplete
{
	reference[0] = SPLIT(reference[0],' with',2)[0] //hogehoge with hemohemo
	ref_id = ''
	if reference[0] == "shell" {
		ref_id = 'shell'
	}
	elseif reference[0] == "ghost" {
		ref_id = 'ghost'
	}
	elseif reference[0] == "balloon" {
		ref_id = 'balloon'
	}

	<<"
	＠設定：クイックセクション
	真【R0 == 'shell'】：【シェル
	真【R0 == 'ghost'】：【ゴースト
	真【R0 == 'balloon'】：【バルーン
	真【R0 == 'plugin'】：【プラグイン
	真【それ以外】：【タイプ不明
	改行なし真：、インストール完了】
	改行多め真：『%(reference[1])』
 	#改行多め真【STRLEN(ref_id) > 0】：切り替えますか？
 	#＠メニュー【直前】：切り替える｜OnAYATEMPLATE.InstallChange｜%(ref_id)
 	#＠メニュー【直前】：切り替えない｜Menu_CANCEL
	">>
}

//------------------------------------------------------------------------------
//インストール失敗メッセージ
//------------------------------------------------------------------------------
OnInstallFailure
{
	<<"
	真：\_q【インストール失敗：%(reference[0])】\_q
	真6【rank!=0】：うわっ、なんだこれー。
	">>
}

//------------------------------------------------------------------------------
//インストール拒否(他のゴーストのためのアーカイブだった)
//------------------------------------------------------------------------------
OnInstallRefuse
{
	<<"
	＠設定：クイックセクション
	真：【インストール失敗】
	『%(reference[0])』用のアーカイブです
	">>
}


//******************************************************************************
//消滅関連
//******************************************************************************

//------------------------------------------------------------------------------
//消滅指示
//------------------------------------------------------------------------------
OnVanishSelecting
{
	<<"
	ユ【rank==0】：(……そろそろ帰ろう。
	ここにはもう、来ない気がする)\w9
	真6【rank!=0】：え、(ユーザ)さん、もう来ないの？\w9
	">>
}

//------------------------------------------------------------------------------
//消滅開始
//------------------------------------------------------------------------------
OnVanishSelected
{
	<<"
	ユ【rank==0】：(結局、あの子は何者だったんだろうか)\w9
	真14【rank!=0】：…………そっか。\n\n[half]\s[9]気が変わったら、いつでも来てよね。
	">>
}

//------------------------------------------------------------------------------
//消滅中止
//------------------------------------------------------------------------------
OnVanishCancel
{
	<<"
	ユ【rank==0】：(…いや、もう少し作業していこう)
	真12【rank!=0】：もう！ 変なこと言わないでよー。\n\n[half]\s[5]……よかった。
	">>
}

//------------------------------------------------------------------------------
//他のゴーストが消滅して自分に切り替わった
//------------------------------------------------------------------------------
OnVanished
{
	if rank != 0 {
		<<"
		真6：どしたの、(ユーザ)さん？\n\n[half]…なんか、元気ないね。
		">>
	}
}


//******************************************************************************
//メールチェック
//******************************************************************************

//------------------------------------------------------------------------------
//メールチェック開始
//------------------------------------------------------------------------------
OnBIFFBegin
{
	<<"
	真：\_q【メールチェック】\_q\w9
	真【rank!=0】：あ、パソコンに何か出てるよ。\nメールじゃない？
	">>
}

//------------------------------------------------------------------------------
//メールチェック成功
//------------------------------------------------------------------------------
OnBIFFComplete
{
	if reference[0] == 0
	{
		//---- メールは無かった
		<<"
		真：\_q【新着メールなし】\_q
		真6【rank!=0】：あ、違った。
		">>
	}
	else
	{
		//---- メールが届いていた
		<<"
		＠設定：クイックセクション
		真：【新着メールあり】
		真【rank==0】：%(reference[0])通のメールが来ています
		＠設定：クイックセクション
		真【rank!=0】：%(reference[0])通のメールがきてます、だって。
		">>
	}
}

//------------------------------------------------------------------------------
//メールチェック失敗
//------------------------------------------------------------------------------
OnBIFFFailure
{
	if reference[0] == "timeout"
	{
		//---- タイムアウト
		<<"
		真：\_q【メールチェック失敗：タイムアウトしました】\_q
		真6【rank!=0】：あれ、なんだこれ。
		">>
	}
	elseif reference[0] == "kick"
	{
		//---- 蹴られた
		<<"
		真：\_q【メールチェック失敗：キックされました】\_q
		真6【rank!=0】：あれ、なんだこれ。
		">>
	}
	elseif reference[0] == "defect"
	{
		//---- 設定誤り
		<<"
		真：\_q【メールチェック失敗：設定が間違っています】\_q
		真6【rank!=0】：あれ、なんだこれ。
		">>
	}
	else
	{
		//---- 原因不明
		<<"
		真：\_q【メールチェック失敗：原因不明のエラー】\_q
		真6【rank!=0】：あれ、なんだこれ。
		">>
	}
}


//******************************************************************************
//ネットワーク更新
//******************************************************************************

//------------------------------------------------------------------------------
//ネットワーク更新開始
//------------------------------------------------------------------------------
OnUpdateBegin
{
	<<"
	真：\_q【ネットワーク更新チェック】\_q\w9
	真8【rank>=2】：みてみてー。\w9\n\s[0]今月の雑誌に載ってるんだよ、俺！\w9
	">>
}

//------------------------------------------------------------------------------
//ネットワーク更新準備完了
//------------------------------------------------------------------------------
OnUpdateReady
{
	<<"
	真：\_q【更新開始】\_q\w9
	真【rank>=2】：ほら、\w7これ。\w9\s[8]カッコイイでしょー。\w9\w9
	">>
}

//------------------------------------------------------------------------------
//ネットワーク更新終了
//------------------------------------------------------------------------------
OnUpdateComplete
{
		if reference[0] == "none" {
			//---- 更新すべきファイルが無かった
			<<"
			真：\_q【更新ファイルなし】\_q\w9
			真7【rank>=2】：あれ。\w9\n俺が載ってるの、\w7来月のやつだった…。\w9
			">>
			} else {
			//---- 実際に更新が完了した
			一体化
			--
			<<"
			真：\_q【ネットワーク更新完了】\_q\w9
			真8【rank>2】：えへへ。\w9
			">>
			}
}
//------------------------------------------------------------------------------
//ネットワーク更新失敗
//------------------------------------------------------------------------------
OnUpdate.OnMD5CompareFailure {
	<<"
	真：\_q【MD5不一致】\w5
	">>
}

OnUpdateFailure
{
	<<"
	＠設定：クイックセクション
	真：【ネットワーク更新失敗：
	改行なし真【R0 == 'timeout'】：時間切れ】
	改行なし真【R0 == 'md5 miss'】：ファイル破損】
	改行なし真【それ以外】：%(reference[0])】\w9
	＠設定：クイックセクション
	真7【rank>=2】：うわ！ コーヒーこぼしちゃった！\w9
	">>
}

//******************************************************************************
//ヘッドラインセンス
//******************************************************************************

//------------------------------------------------------------------------------
//ヘッドラインセンス開始
//------------------------------------------------------------------------------
OnHeadlinesenseBegin
{
	if rank != 0 {
		<<"
		真【rank!=0】：言ってた雑誌、持ってきたよ。
		-----
		真【rank!=0】：こういうの読むんだね。
		">>
	}
}

//------------------------------------------------------------------------------
//ヘッドライン読み上げ
//------------------------------------------------------------------------------
OnHeadlinesense.OnFind
{
	<<"
	真【R2=="First" || R2=="First and Last"】：\b2\_q%(reference[0])\_q
	真：\b2\_q\n[half]%(reference[3])\_q
	＠半分メニュー【'Last' !_in_ R2】：次へ|
	＠半分メニュー【直前分岐】：サイトへ|%(reference[1])
	＠メニュー【それ以外】：サイトへ|%(reference[1])
	＠メニュー：閉じる|Menu_HEADLINECANCEL
	">>
}

//------------------------------------------------------------------------------
//ヘッドラインセンス失敗
//------------------------------------------------------------------------------
OnHeadlinesenseFailure
{
	<<"
	真：\_q【ヘッドライン取得失敗】\_q
	真7【rank!=0】：あっ、違うの持ってきちゃった。
	">>
}


//******************************************************************************
//ファイル作成関連
//******************************************************************************

//------------------------------------------------------------------------------
//updates2.dau作成開始
//------------------------------------------------------------------------------
OnUpdatedataCreating
{
	<<"
	真：\_q【updates2.dauを作成】\_q
	">>
}

//------------------------------------------------------------------------------
//updates2.dau作成完了
//------------------------------------------------------------------------------
OnUpdatedataCreated
{
	<<"
	真：\_q【updates2.dau作成完了】\_q
	">>
}

//------------------------------------------------------------------------------
//NAR作成開始
//------------------------------------------------------------------------------
OnNarCreating
{
	<<"
	真：\_q【NARファイルを作成】\_q
	">>
}

//------------------------------------------------------------------------------
//NAR作成完了
//------------------------------------------------------------------------------
OnNarCreated
{
	<<"
	＠設定：クイックセクション
	真：【NARファイル作成完了】
	改行多め真：『%(reference[0])』\n\n[half]%(reference[1])
	＠設定：クイックセクション
	">>
}

//******************************************************************************
//時計合わせ
//みか (http://homepage2.nifty.com/ko-ki/) の辞書を参考にしました。感謝＞こーき氏
//******************************************************************************

//------------------------------------------------------------------------------
//時計合わせ開始
//------------------------------------------------------------------------------
OnSNTPBegin
{
	<<"
	真：\_q【時計合わせ】\_q
	真【rank!=0】：時計合わせてあげるね。
	">>
}

//------------------------------------------------------------------------------
//時刻取得成功、比較開始
//この関数で 2008/03/25 19:15:05 のように見やすい形に作り変えます。
//詳しくはSTRFORM関数の説明を見てね！
//わからなければこのままで。
//------------------------------------------------------------------------------

SNTPCompare_StrForm
{
	_txt = SPLIT(_argv[0],',')
	STRFORM("$04d/$02d/$02d $02d:$02d:$02d",TOINT(_txt[0]),TOINT(_txt[1]),TOINT(_txt[2]),TOINT(_txt[3]),TOINT(_txt[4]),TOINT(_txt[5]))
}

OnSNTPCompare
{
	<<"
	＠設定：クイックセクション
	真：【時計合わせ完了】
	真：修正前 %(SNTPCompare_StrForm(reference[2]))
	真：修正後 %(SNTPCompare_StrForm(reference[1]))
	＠設定：クイックセクション
	真【rank!=0】：終わったよ。
	真6【rank!=0 && TOINT(R3)==0】：なんだ、ぴったりじゃん。
	真1【rank!=0 && TOINT(R3)!=0】：%(reference[3])秒もずれてたね。
	">>
}

//------------------------------------------------------------------------------
//時計合わせ失敗
//------------------------------------------------------------------------------
OnSNTPFailure
{
	<<"
	真：\_q【時計合わせ失敗】\_q
	真12【rank!=0】：うーん…これはちょっと分かんないや。
	">>
}


//******************************************************************************
//そのほか
//******************************************************************************

//------------------------------------------------------------------------------
//URLドロップ
//CROW でゴーストインストーラからゴーストをインストールを始めた時にも呼ばれます
//------------------------------------------------------------------------------
OnURLDropping
{
	if rank != 0 {
		<<"
		真：これ、くれるの？
		">>
	}
}

//******************************************************************************
//開発用メニュー
//******************************************************************************

Menu_USERCOMSTART
{
	<<"
	ユ：(こちらは開発用メニューになります。)\![open,communicatebox]
	">>
}

ユーザーコミュsetrank_0
{
	rank = 0
	"\0ランクを%(rank)に設定"
}
ユーザーコミュsetrank_1
{
	rank = 1
	"\0ランクを%(rank)に設定"
}
ユーザーコミュsetrank_2
{
	rank = 2
	"\0ランクを%(rank)に設定"
}
ユーザーコミュsetrank_3
{
	rank = 3
	"\0ランクを%(rank)に設定"
}

ユーザーコミュflagtalk
{
	"%(flag_talk)"
}

ユーザーコミュruflag
{
	"%(ru_flag)"
}